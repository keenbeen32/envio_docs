---
title: "Indexing Sway Farm on the Fuel Network"
description: "Learn how to index Sway Farm on Fuel and track player events with Envio."
---

Until recently, HyperIndex was only available on EVM-compatible blockchains, and now we have extended support to the [Fuel](https://fuel.network/) Network.

Indexers are vital to the success of any dApp. In this tutorial, we will create an Envio indexer for the Fuel dApp [Sway Farm](https://swayfarm.xyz/) step by step.

Sway Farm is a simple farming game and for the sake of a real-world example, let's create the indexer for a leaderboard of all farmers üßë‚Äçüåæ

<img src="/images/docs-assets/tutorial-indexing-fuel-farm.webp" alt="Sway Farm" width="100%"/>

## About Fuel

[Fuel](https://fuel.network/) is an operating system purpose-built for Ethereum rollups. Fuel's unique architecture allows rollups to solve for PSI (parallelization, state minimized execution, interoperability). Powered by the FuelVM, Fuel aims to expand Ethereum's capability set without compromising security or decentralization.

[Website](https://fuel.network/) | [X](https://twitter.com/fuel_network?lang=en) | [Discord](https://discord.com/invite/xfpK4Pe)

## Prerequisites

<CardGroup cols={3}>
  <Card title="Node.js" icon="node-js" href="https://nodejs.org/en/download/current">
    v22 or newer recommended
  </Card>
  
  <Card title="pnpm" icon="box" href="https://pnpm.io/installation">
    v8 or newer
  </Card>
  
  <Card title="Docker Desktop" icon="docker" href="https://www.docker.com/products/docker-desktop/">
    Required for local development
  </Card>
</CardGroup>

<Note>
Docker is specifically required to run your indexer locally. You can skip Docker installation if you plan only to use Envio's hosted service.
</Note>

## Initialize the Project

Now that you have installed the prerequisite packages let's begin the practical steps of setting up the indexer.

<Steps>

<Step title="Run the init command">
Open your terminal in an empty directory and initialize a new indexer:

```bash icon="terminal" title="terminal"
pnpx envio init
```
</Step>

<Step title="Choose directory">
In the following prompt, choose the directory where you want to set up your project:

```bash icon="terminal" title="terminal"
? Specify a folder name (ENTER to skip): sway-farm-indexer
```
</Step>

<Step title="Choose language">
Choose TypeScript for the event handlers:

```bash icon="terminal" title="terminal"
? Which language would you like to use?
  JavaScript
> TypeScript
  ReScript
```
</Step>

<Step title="Choose blockchain ecosystem">
Select Fuel as the blockchain ecosystem:

```bash icon="terminal" title="terminal"
? Choose blockchain ecosystem
  Evm
> Fuel
```
</Step>

<Step title="Choose initialization option">
Select Contract Import to create an indexer for an existing contract:

```bash icon="terminal" title="terminal"
? Choose an initialization option
  Template
> Contract Import
```

<Tip>
A separate [Tutorial](/HyperIndex/Tutorials/greeter-tutorial) page provides more details about the Greeter template.
</Tip>
</Step>

<Step title="Provide ABI file">
Provide the path to your ABI file (found in `./out/debug` after building your Sway contract):

```bash icon="terminal" title="terminal"
? What is the path to your json abi file? ./sway-farm/contract/out/debug/contract-abi.json
```
</Step>

<Step title="Select events">
After the ABI file is provided, Envio parses all possible events. Select the events you want to index:

```bash icon="terminal" title="terminal"
? Which events would you like to index?
> [x] NewPlayer
  [ ] PlantSeed
  [x] SellItem
  [ ] InvalidError
  [ ] Harvest
  [ ] BuySeeds
  [x] LevelUp
```

For this tutorial, we only need events that update player information: `NewPlayer`, `LevelUp`, and `SellItem`.

<Info>
For the tutorial we only need to index `LOG_DATA` receipts, but you can also index `Mint`, `Burn`, `Transfer` and `Call` receipts. Read more about [Supported Event Types](/HyperIndex/fuel/fuel#features-supported-on-fuel).
</Info>
</Step>

<Step title="Name your contract">
```bash icon="terminal" title="terminal"
? What is the name of this contract? SwayFarm
```
</Step>

<Step title="Set contract address">
```bash icon="terminal" title="terminal"
? What is the address of the contract? 0xf5b08689ada97df7fd2fbd67bee7dea6d219f117c1dc9345245da16fe4e99111
```
</Step>

<Step title="Finish initialization">
```bash icon="terminal" title="terminal"
? Would you like to add another contract?
> I'm finished
  Add a new address for same contract on same network
  Add a new contract (with a different ABI)
```

If you see the following line, it means we are already halfway through üôå

```
Please run `cd sway-farm-indexer` to run the rest of the envio commands
```
</Step>

</Steps>

Let's open the indexer in an IDE and start adjusting it for our farm üçÖ

## Walk Through Initialized Indexer

At this point, we should already have a working indexer. You can start it by running `pnpm dev`, which we cover in more detail later in the tutorial.

Everything is configured by modifying the 3 files below:

- `config.yaml` - [Guide](/HyperIndex/Guides/configuration-file)
- `schema.graphql` - [Guide](/HyperIndex/Guides/schema-file)
- `EventHandlers.*` - [Guide](/HyperIndex/Guides/event-handlers)

### `config.yaml`

The `config.yaml` outlines the specifications for the indexer, including details such as network and contract specifications and the event information to be used in the indexing process.

```yaml icon="/icons/yaml-icon.png" title="config.yaml"
name: sway-farm-indexer
ecosystem: fuel
networks:
  - id: 0
    start_block: 0
    contracts:
      - name: SwayFarm
        address:
          - 0xf5b08689ada97df7fd2fbd67bee7dea6d219f117c1dc9345245da16fe4e99111
        abi_file_path: abis/swayfarm-abi.json
        handler: src/EventHandlers.ts
        events:
          - name: SellItem
            logId: "11192939610819626128"
          - name: LevelUp
            logId: "9956391856148830557"
          - name: NewPlayer
            logId: "169340015036328252"
```

In the tutorial, we don't need to adjust it in any way. But later you can modify the file and add more events for indexing.

As a nice to have, you can use a Sway struct name without specifying a `logId`, like this:

```yaml
- name: SellItem
- name: LevelUp
- name: NewPlayer
```

### `schema.graphql`

The `schema.graphql` file serves as a representation of your application's data model. It defines entity types that directly correspond to database tables, and the event handlers you create are responsible for creating and updating records within those tables.

For the leaderboard, we need only one entity representing the player. Let's create it:

```graphql icon="/icons/graphql-icon.png" title="schema.graphql"
type Player {
  id: ID!
  farmingSkill: BigInt!
  totalValueSold: BigInt!
}
```

We will use the user address as an ID. The fields `farmingSkill` and `totalValueSold` are `u64` in Sway, so to safely map them to JavaScript value, we'll use `BigInt`.

### `EventHandlers.ts`

The event handlers generated by contract import are quite simple and only add an entity to a DB when a related event is indexed.

```typescript icon="/icons/typescript-icon.png" title="EventHandlers.ts"
import { SwayFarmContract, SwayFarm_SellItemEntity } from "generated";

SwayFarmContract.SellItem.handler(async ({ event, context }) => {
  const entity: SwayFarm_SellItemEntity = {
    id: `${event.chainId}_${event.block.height}_${event.logIndex}`,
  };

  context.SwayFarm_SellItem.set(entity);
});
```

Let's modify the handlers to update the `Player` entity instead. But before we start, we need to run `pnpm codegen` to generate utility code and types for the `Player` entity we've added.

```bash icon="terminal" title="terminal"
pnpm codegen
```

It's time for a little bit of coding. The indexer is very simple; it requires us only to pass event data to an entity.

```typescript icon="/icons/typescript-icon.png" title="EventHandlers.ts"
import { SwayFarmContract } from "generated";

/**
Registers a handler that processes NewPlayer event
on the SwayFarm contract and stores the players in the DB
*/
SwayFarmContract.NewPlayer.handler(async ({ event, context }) => {
  // Set the Player entity in the DB with the intial values
  context.Player.set({
    // The address in Sway is a union type of user Address and ContractID
    id: event.params.address.payload.bits,
    // Initial values taken from the contract logic
    farmingSkill: 1n,
    totalValueSold: 0n,
  });
});

SwayFarmContract.LevelUp.handler(async ({ event, context }) => {
  const playerInfo = event.params.player_info;
  context.Player.set({
    id: event.params.address.payload.bits,
    farmingSkill: playerInfo.farming_skill,
    totalValueSold: playerInfo.total_value_sold,
  });
});

SwayFarmContract.SellItem.handler(async ({ event, context }) => {
  const playerInfo = event.params.player_info;
  context.Player.set({
    id: event.params.address.payload.bits,
    farmingSkill: playerInfo.farming_skill,
    totalValueSold: playerInfo.total_value_sold,
  });
});
```

Without overengineering, simply set the player data into the database. What's nice is that whenever your ABI or entities in `graphql.schema` change, Envio regenerates types and shows the compilation error.

<Tip>
You can find the indexer repo created during the tutorial on [GitHub](https://github.com/enviodev/sway-farm-indexer).
</Tip>

## Starting the Indexer

<Warning>
Make sure you have Docker open before running the following command.
</Warning>

The following commands will start the docker and create databases for indexed data. Make sure to re-run `pnpm dev` if you've made some changes.

```bash icon="terminal" title="terminal"
pnpm dev
```

<img src="/images/docs-assets/tutorial-indexing-fuel-running-indexer.webp" alt="Running indexer" width="100%"/>

Nice, we indexed `1,721,352` blocks containing `58,784` events in 10 seconds, and they continue coming in.

## View the Indexed Results

Let's check indexed players on the local Hasura server.

```bash icon="terminal" title="terminal"
open http://localhost:8080
```

The Hasura admin-secret / password is `testing`, and the tables can be viewed in the data tab or queried from the playground.

<img src="/images/docs-assets/tutorial-indexing-fuel-graphiql.webp" alt="GraphiQL example" width="100%"/>

Now, we can easily get the top 5 players, the number of inactive and active players, and the average sold value. What's left is a nice UI for the Sway Farm leaderboard, but that's not the tutorial's topic.

<Tip>
A separate [Guide](/HyperIndex/Guides/navigating-hasura) page provides more details about navigating Hasura.
</Tip>

## Deploy the Indexer onto the Hosted Service

Once you have verified that the indexer is working for your contracts, then you are ready to deploy the indexer onto our hosted service.

Deploying an indexer onto the hosted service allows you to extract information via graphQL queries into your front-end or some back-end application.

Navigate to the [hosted service](https://envio.dev/app/login) to start deploying your indexer and refer to this [documentation](/HyperIndex/Hosted_Service/hosted-service) for more information on deploying your indexer.

## What Next?

Once you have successfully finished the tutorial, you are ready to become a blockchain indexing wizard!

Join our [Discord](https://discord.com/invite/gt7yEUZKeB) channel to make sure you catch all new releases.

